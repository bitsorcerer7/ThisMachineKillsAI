vulnfile = open('VulnData.txt','r')
accuracyfile = open('AccuracyRatings.txt','r')

# Pull in and clean up data
vulnlist = vulnfile.readlines()
accuracies = accuracyfile.readlines()
vuln_list = [ele.replace('\n','') for ele in vulnlist]
vuln_list = [ele.replace('L','2') for ele in vuln_list]
vuln_list = [ele.replace('M','3') for ele in vuln_list]
vuln_list = [ele.replace('H','5') for ele in vuln_list]
vuln_list = [ele.replace(' C ',' 8 ') for ele in vuln_list]
accuracies_list = [ele.replace('\t',' ') for ele in accuracies]
accuracies_list = [ele.replace('\n','') for ele in accuracies_list]

def vuln_score_calc(list):
    if list[1] == "V":
        score = round(float(list[2])*(1 - (((float(list[3]) + float(list[4])) * 5) / 100)), 1)
    else:
        score = 0.0
    return score

# Recalculate the scores with complexity as barrier
# Add these to the data
for i in range(len(vuln_list)):
    attribute_list = vuln_list[i].split()
    score = vuln_score_calc(attribute_list)
    vuln_list[i] = vuln_list[i] + ' ' + str(score)

#generate list of participants based on accruacy ratings list
for i in range(len(accuracies_list)):
    pseudo = accuracies_list[i].split()
    name = pseudo[0]
    for j in range(len(vuln_list)):
        attribute_list = vuln_list[j].split()
        if name == attribute_list[0]:
            accuracies_list[i] = accuracies_list[i] + ' ' + attribute_list[5]

# Create a sortable list and fill it with the final score calculations
rows, cols = (len(accuracies_list), 2)
display = [[None for i in range(cols)] for j in range(rows)]
for i in range(len(accuracies_list)):
    sum_list = accuracies_list[i].split()
    score_total = 0.0
    for j in range(2, len(sum_list)):
        score_total += float(sum_list[j])
        final_score = score_total * float(sum_list[1])
    display[i][0] = sum_list[0]
    display[i][1] = round(final_score, 1)

display.sort(reverse=True, key=lambda x: x[1])

# Display results
print("ARTEMIS Rescore:")
for each in display:
    print('|', each[0].ljust(4), end='')
print('')
for each in display:
    print('|', str(each[1]).ljust(4), end='')
